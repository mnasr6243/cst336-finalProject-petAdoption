<%- include("partials/header") %>

  <section>
    <header class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="h3 mb-1">Available Animals</h1>
        <p class="small text-muted mb-0">
          Browse pets currently available for adoption.
        </p>
      </div>
    </header>

    <% if (!animals || animals.length===0) { %>
      <p class="text-muted">No animals available right now. Check back soon!</p>
      <% } else { %>

        <section class="row g-3">
          <% animals.forEach(a=> { %>
            <article class="col-md-4">
              <div class="card h-100 animal-card">
                <div class="card-body d-flex flex-column">

                  <% if (a.image) { %>
                    <img src="<%= a.image %>" class="img-fluid rounded mb-2" alt="<%= a.animalName %>">
                    <% } else { %>
                      <img src="https://via.placeholder.com/400x250?text=No+Image" class="img-fluid rounded mb-2"
                        alt="No image">
                      <% } %>

                        <h2 class="h5">
                          <%= a.animalName %>
                        </h2>

                        <p class="mb-1 small text-muted">
                          <strong>Species:</strong>
                          <%= a.species %>
                        </p>

                        <% if (a.age !==null) { %>
                          <p class="mb-3 small text-muted">
                            <strong>Age:</strong>
                            <%= a.age %> year(s)
                          </p>
                          <% } %>

                            <button class="btn btn-outline-primary btn-sm mt-auto js-show-animal"
                              data-animal-name="<%= a.animalName %>" data-species="<%= a.species %>"
                              data-age="<%= a.age %>" data-status="<%= a.status %>">
                              View details
                            </button>

                            <a href="/adopt/<%= a.animalId %>" class="btn btn-success btn-sm mt-2">
                              Adopt
                            </a>
                </div>
              </div>
            </article>
            <% }) %>
        </section>

        <% } %>
  </section>

  <!-- Modal used for details (populated by JS) -->
  <div class="modal fade" id="animalModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="animalModalTitle">Animal details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p><strong>Species:</strong> <span id="modalSpecies"></span></p>
          <p><strong>Age:</strong> <span id="modalAge"></span></p>
          <p><strong>Status:</strong> <span id="modalStatus"></span></p>

          <hr>
          <p class="small text-muted mb-1">
            This modal is filled using values from the database via data attributes.
          </p>
          <p class="small text-muted mb-0">
            We also save the last viewed species in localStorage.
          </p>
        </div>
      </div>
    </div>
  </div>

  <%- include("partials/animalModalScript") %>
    <%- include("partials/footer") %>